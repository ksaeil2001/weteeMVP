# CLAUDE.md

## 1. 프로젝트 개요

- 프로젝트명: 개인 과외 관리 통합 플랫폼 (가칭 WeTee)
- 목적:
  - 과외 선생님, 학생, 학부모가 겪는 **파편화된 도구, 불투명한 정산, 반복적인 행정 업무**를 한 곳에서 해결하는 통합 관리 서비스
  - 일정, 출결, 진도, 정산, 알림을 하나의 플랫폼에서 관리하여, 사용자가 **더 가치 있는 일(수업 준비, 학생 관리)에 집중**하도록 돕는 것
- 핵심 사용자:
  - 개인 과외 선생님
  - 과외를 맡기는 학부모
  - 학생 (중·고등학생 중심)

이 레포는 이 서비스를 위한 **MVP 1단계 기능(F-001~F-008)**의 프론트엔드, 백엔드, 데이터베이스를 구현하기 위한 코드 저장소다.

---

## 2. 문서 구조와 우선순위

이 레포에는 이미 상세한 기획/설계 문서가 포함되어 있다.  
Claude는 코드를 작성하기 전에 아래 문서들을 **반드시 우선 읽어야 한다.**

1. `01_문제_정의_및_목표_설정.md`
   - 이 프로젝트가 해결하려는 문제, 대상 사용자, 성공 기준을 정의한 **최상위 기획 문서**
   - 모든 기능/디자인 의사결정은 이 문서의 문제 정의와 목표를 우선적으로 존중해야 한다.

2. 기능 명세서 `F-001` ~ `F-008`
   - 각 기능별 요구사항, 사용자 시나리오, 예외 케이스, UI 요구사항이 정리된 문서들
   - 비즈니스 로직, 화면 구성, 플로우에 대한 **소스 오브 트루스(Source of Truth)**

3. `API_명세서.md`
   - 프론트엔드와 백엔드 사이의 **REST API 계약서**
   - 엔드포인트 URL, HTTP 메서드, 요청/응답 스키마, 에러 코드, 인증 규칙 등을 정의

4. `데이터베이스_설계서.md`
   - PostgreSQL 기반 데이터베이스 구조와 테이블·관계 정의
   - ERD, 테이블 목록, 컬럼, 인덱스, 제약조건, 성능·보안 정책 등을 포함

5. `기술스택_설계서.md`
   - 프론트엔드·백엔드·인프라 전체 아키텍처와 사용 기술, 버전 명시
   - React / React Native, FastAPI, PostgreSQL, Redis, S3 등 선택 이유와 사용 방식 설명

### 문서 해석 우선순위

문서 간 내용이 충돌하거나 해석이 애매할 때는 다음 순서를 따른다.

1. `01_문제_정의_및_목표_설정.md` (문제·목표)
2. 기능 명세서 `F-001` ~ `F-008` (기능·플로우·UI 요구사항)
3. `API_명세서.md` (엔드포인트·요청/응답 형식)
4. `데이터베이스_설계서.md` (테이블·관계 구조)
5. `기술스택_설계서.md` (기술 선택·버전, 비기능 요구사항)

코드를 작성할 때는 **기능 명세서의 요구사항을 절대적으로 우선**하고, 다른 문서와 어긋나는 경우에는:
- 우선 기능 명세서를 기준으로 구현하되,
- 필요한 경우 “어떤 부분이 충돌하는지”를 주석 또는 설명으로 명확히 남긴다.

---

## 3. 구현 범위 (MVP 1단계)

MVP 1단계에서 구현해야 할 기능은 다음 8개다.

1. `F-001_회원가입_및_로그인.md`
2. `F-002_과외_그룹_생성_및_매칭.md`
3. `F-003_수업_일정_관리.md`
4. `F-004_출결_관리.md`
5. `F-005_수업_기록_및_진도_관리.md`
6. `F-006_수업료_정산.md`
7. `F-007_기본_프로필_및_설정.md`
8. `F-008_필수_알림_시스템.md`

### 반드시 **지금 구현하지 말아야 할 것들**

- 각 기능 명세서의 “개선 아이디어”, “향후 확장”, “2단계에서 고려” 등으로 표시된 내용
- AI 추천, 고급 통계/분석, 검색 고도화(Elasticsearch 중심 기능) 등 2단계 이후로 미뤄둔 기능
- 이메일/SMS 알림, 고급 알림 필터링 등 F-008에서 의도적으로 제외한 고급 옵션

이 내용들은 코드에 **훅(hook) 정도의 여지만 남기고**, 실제 구현은 하지 않는다.

---

## 4. 기술 스택 요약 (실제 구현 기준)

이 레포에서 Claude가 가정해야 할 기본 기술 스택은 다음과 같다.

### 백엔드

- 언어 및 프레임워크: Python 3.11 + FastAPI
- 주요 역할:
  - 인증/인가(JWT)
  - 그룹/일정/출결/수업 기록/정산/프로필/알림 관련 REST API 제공
  - 토스페이먼츠 Webhook 처리 (정산·결제 연동)
- 비기능 요구사항:
  - Pydantic 모델 기반 요청/응답 검증
  - 공통 에러 처리 미들웨어
  - Rate Limiting, 로깅, 모니터링 등은 기술스택 설계서 기준으로 최소 수준 반영

### 데이터베이스

- 엔진: PostgreSQL 15.x
- 핵심 테이블(요약):
  - `users`, `teachers`, `students`, `parents`
  - `groups`, `group_members`, `invite_codes`
  - `schedules`, `attendances`, `lesson_records`, `progress_records`
  - `payments`, `invoices`, `transactions`
  - `notifications`, `settings`, (필요 시) `login_history`
- 관계 구조와 상세 스키마는 `데이터베이스_설계서.md`를 따른다.

### 프론트엔드

- 클라이언트:
  - 모바일 앱: React Native
  - 웹 앱: React 기반 SPA
- 역할:
  - F-001~F-008에서 정의한 화면/플로우/상태를 구현
  - 모든 데이터는 백엔드 API를 통해 가져오며, 프론트엔드는 비즈니스 규칙을 새로 정의하지 않는다.

(이 레포에서 실제로 어떤 클라이언트를 우선 구현할지는, 디렉터리 구조 또는 추가 설명에 따라 조정한다. 명시가 없으면 우선 “웹(React)용 관리 화면”을 기준으로 설계해도 된다.)

---

## 5. 개발 원칙 (Claude가 반드시 지켜야 할 규칙)

1. **문서를 먼저 읽고 요약한 뒤 코드를 작성한다.**
   - 단일 기능을 구현하더라도 관련 기능 명세서(F-00X), API, DB 문서를 먼저 읽고,
   - “이 기능이 해결하려는 문제”와 “핵심 플로우”를 2~3줄로 정리한 뒤 구현을 시작한다.

2. **기능 명세서의 “UI 요구사항”을 그대로 반영한다.**
   - 화면 구성, 필수 버튼, 필드, 상태, 권한(누가 보고/누가 수정하는지)은 기능 명세서의 UI 요구사항 섹션을 최우선으로 따른다.
   - 모호한 부분이 있으면 `01_문제_정의_및_목표_설정.md`의 페르소나·상황을 참고해 합리적인 기본값을 선택한다.

3. **비즈니스 로직은 프론트엔드에서 새로 발명하지 않는다.**
   - “어떤 값이 언제 생성/변경되는지”는 가능한 한 백엔드에서 책임진다.
   - 프론트엔드는 입력·검증·표시·상태 관리에 집중하고, 핵심 규칙은 API 스펙과 DB 설계를 따른다.

4. **API 명세와 DB 설계를 가능한 한 그대로 사용한다.**
   - 새 엔드포인트를 만들기보다, `API_명세서.md`에 정의된 엔드포인트를 우선 사용한다.
   - DB에 없는 필드/테이블을 임의로 만들지 말고, 필요하면:
     - 우선 임시 필드나 TODO 주석으로 표시하고,
     - “어떤 기능 때문에 어떤 필드/테이블이 필요해 보이는지”를 명시한다.

5. **작은 단위로 작업하고, 각 단계마다 무엇을 했는지 설명한다.**
   - “디렉터리 구조 설계 → 모델/스키마 정의 → API 라우트 구현 → 프론트엔드 화면/컴포넌트 구현 → 간단한 테스트” 순서를 권장한다.
   - 한 번에 레포 전체를 갈아엎는 큰 변경보다, 기능 단위·화면 단위로 점진적으로 구현한다.

6. **문서의 설계 원칙을 깨지 않는다.**
   - 각 문서에 정의된 “중복 금지, 추상화 레벨, 영향 범위 최소화” 원칙을 존중한다.
   - 예를 들어:
     - 기능 명세서에 있는 내용을 API 문서에 중복 서술하지 말고, 필요한 경우 “참조”만 한다.
     - DB 설계 내용을 기능 명세서에 다시 쓰려고 하지 않는다.

---

## 6. 기능별 구현 가이드

각 기능을 구현할 때 Claude가 기본적으로 따라야 할 체크리스트를 정리한다.

### F-001 회원가입 및 로그인

- 참고 문서:
  - `F-001_회원가입_및_로그인.md`
  - `API_명세서.md`의 F-001 관련 섹션
  - `데이터베이스_설계서.md`의 `users`, `teachers`, `students`, `parents` 테이블
- 구현 목표:
  - 이메일/비밀번호 기반 회원가입, 로그인, 로그아웃
  - 역할(선생님/학부모/학생) 선택 및 저장
  - 비밀번호 재설정(가능하면 토큰 기반 플로우까지 고려)
- 주의점:
  - 무차별 대입 공격 방지 (Rate Limiting, 잠금 정책 등)
  - JWT 기반 인증 구조 및 토큰 저장 위치(클라이언트)

### F-002 과외 그룹 생성 및 매칭

- 참고 문서:
  - `F-002_과외_그룹_생성_및_매칭.md`
  - `API_명세서.md`의 F-002 관련 섹션
  - `데이터베이스_설계서.md`의 `groups`, `group_members`, `invite_codes`
- 구현 목표:
  - 선생님이 과외 그룹 생성, 학생·학부모 초대/매칭
  - 그룹 정보(과목, 학년, 요일/시간 등) 관리
- 주의점:
  - 권한(그룹 생성·수정은 선생님, 조회는 학생/학부모)
  - 초대 코드/링크의 유효기간 및 상태 관리

### F-003 수업 일정 관리

- 참고 문서:
  - `F-003_수업_일정_관리.md`
  - 관련 API 및 DB의 `schedules`, `attendances` 등
- 구현 목표:
  - 정규 수업 일정 등록, 수정, 삭제
  - 보강 수업 일정 관리
  - 달력 뷰에서 수업 일정 시각화
- 주의점:
  - 반복 일정 규칙 처리
  - 시간대, 휴일, 보강·결석 처리와의 연계

### F-004 출결 관리

- 참고 문서:
  - `F-004_출결_관리.md`
  - `attendances` 테이블
- 구현 목표:
  - 선생님의 출석/지각/결석/보강 표시 기능
  - 학생·학부모는 조회만 가능
- 주의점:
  - 일정(F-003) 및 정산(F-006)과의 데이터 연계
  - 상태 변경 히스토리가 필요한지 여부

### F-005 수업 기록 및 진도 관리

- 참고 문서:
  - `F-005_수업_기록_및_진도_관리.md`
  - `lesson_records`, `progress_records`, `textbooks`
- 구현 목표:
  - 수업별 요약, 진도, 숙제 기록
  - 학부모·학생이 확인할 수 있는 뷰 제공
- 주의점:
  - 한 수업에서 여러 교재·진도 기록이 가능하다는 점 반영
  - 나중에 검색/필터링을 고려한 데이터 구조 유지

### F-006 수업료 정산

- 참고 문서:
  - `F-006_수업료_정산.md`
  - `payments`, `invoices`, `transactions`
  - 토스페이먼츠 관련 부분 (Webhook, 결제 상태)
- 구현 목표:
  - 수업 횟수·출결 정보를 바탕으로 한 자동 정산
  - 청구서 생성, 결제 상태 조회
- 주의점:
  - 정산 로직의 소스 오브 트루스는 “출결 + 일정” 데이터
  - 법적 보관 기간, 영수증/거래내역 보관 정책 반영

### F-007 기본 프로필 및 설정

- 참고 문서:
  - `F-007_기본_프로필_및_설정.md`
  - `users`, `settings`, (필요 시) `login_history`
- 구현 목표:
  - 사용자 기본 정보(이름, 연락처, 사진 등) 관리
  - 언어, 알림, 보안 설정 등 환경 설정 화면
- 주의점:
  - “읽기 모드 / 수정 모드 분리” 등 UI 정책 준수
  - 로그인 기록 조회 기능이 필요한 경우, DB 설계서의 `login_history` 테이블 정의를 따른다.

### F-008 필수 알림 시스템

- 참고 문서:
  - `F-008_필수_알림_시스템.md`
  - `notifications` 테이블
- 구현 목표:
  - 수업 일정, 보강, 숙제, 정산 등 핵심 이벤트에 대한 푸시 알림
  - 알림 리스트 화면, 읽음 처리, on/off 설정
- 주의점:
  - MVP에서는 푸시 알림만, 간단한 on/off 수준의 설정만 지원 (고급 필터링은 제외)
  - 알림 보관 기간(예: 90일 등)을 정책대로 적용

---

## 7. Claude Code에서의 작업 방식

이 레포를 열고 작업할 때 Claude는 다음 절차를 따른다.

1. **사용자의 요청에서 “어떤 기능(F-00X)”을 다루는지 먼저 파악한다.**
2. 해당 기능의 기능 명세서(F-00X)와 관련 API/DB/문서를 읽고, 핵심 요구사항을 짧게 요약한다.
3. 구현 범위를 명확히 나눈다.
   - 예: “이번 작업에서는 F-003 중 ‘선생님용 수업 일정 등록/수정 화면 + 관련 API’까지만 구현”
4. 필요한 경우 디렉터리 구조/파일 구조를 먼저 제안한다.
5. 그다음 실제 코드를 작성한다.
   - 백엔드: 모델/스키마 → 라우터 → 서비스 로직 → 간단한 테스트
   - 프론트엔드: 페이지/스크린 → 재사용 가능한 컴포넌트 → 상태 관리 → API 연동
6. 마지막에:
   - 어떤 문서를 근거로 무엇을 구현했는지,
   - 어떤 부분이 아직 TODO인지,
   - 어떤 확장 포인트를 남겨두었는지 정리해서 설명한다.
