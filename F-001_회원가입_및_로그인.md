# F-001: 회원가입 및 로그인

**버전**: v1.0  
**작성일**: 2025-10-31  
**최종 수정일**: 2025-10-31  
**우선순위**: 1단계 MVP  

---

## 1. 이 기능은 왜 필요한가?

회원가입과 로그인은 플랫폼 사용의 가장 기본적인 출발점입니다. 이 기능이 없으면 사용자를 식별할 수 없고, 따라서 다른 어떤 기능도 작동할 수 없습니다.

우리 플랫폼은 **세 가지 사용자 유형**을 명확히 구분해야 합니다:
- **선생님**: 과외 그룹을 생성하고 관리하는 주체
- **학생**: 수업을 듣고 숙제를 제출하는 학습자
- **학부모**: 자녀의 학습을 모니터링하고 비용을 지불하는 보호자

각 유형마다 권한과 기능이 완전히 다르기 때문에, 가입 단계부터 명확히 구분해야 합니다.

### 문제 정의서와의 연결

문제 정의서에서 강조한 **신뢰 기반의 투명한 과외 생태계**를 구축하려면, 사용자 신원을 안전하게 확인하는 것이 시작점입니다. 특히:
- 문제 5 "비공식 금전 거래로 인한 법적 분쟁"을 방지하려면, 사용자가 누구인지 명확히 알아야 합니다.
- 문제 6 "학부모 신뢰 부족"을 해소하려면, 선생님과 학부모가 공식적인 계정으로 연결되어야 합니다.

### 핵심 설계 원칙

1. **선생님만 독립적으로 가입 가능**: 선생님이 먼저 가입하고 과외 그룹을 만든 후, 학생과 학부모를 초대하는 구조입니다.
2. **초대 코드 시스템**: 아무나 학생이나 학부모로 가입할 수 없고, 반드시 선생님의 초대를 받아야 합니다. 이는 안전성과 명확한 관계 설정을 위함입니다.
3. **이메일 인증 필수**: 이메일은 비밀번호 재설정, 중요 알림 발송의 채널이므로 반드시 실제 사용 가능한 이메일이어야 합니다.

---

## 2. 사용자 시나리오

### 시나리오 1: 선생님이 처음 가입하는 경우

**배경**: 김선생님은 과외를 시작하기로 했습니다. 학생과 학부모를 플랫폼으로 초대하기 위해 먼저 자신의 계정을 만들어야 합니다.

**단계**:

1. 김선생님이 앱을 처음 실행합니다.
2. 화면에 "시작하기" 버튼이 보입니다.
3. "시작하기"를 누르면 **"어떤 사용자이신가요?"** 화면이 나타납니다.
   - 세 가지 옵션: **선생님 / 학생 / 학부모**
   - 각 옵션 아래 간단한 설명
     - 선생님: "과외를 진행하고 학생을 관리합니다"
     - 학생: "수업을 듣고 숙제를 제출합니다 (초대 코드 필요)"
     - 학부모: "자녀의 학습을 확인하고 비용을 결제합니다 (초대 코드 필요)"
4. 김선생님이 **"선생님"**을 선택합니다.
5. 회원가입 폼이 나타납니다. 입력 필드:
   - **이메일**: example@gmail.com
   - **비밀번호**: 8자 이상, 영문+숫자 포함
   - **비밀번호 확인**: 위와 동일하게 재입력
   - **이름**: 김선생
   - **전화번호**: 010-1234-5678 (선택사항)
6. 모든 필드를 채우고 **"가입하기"** 버튼을 누릅니다.
7. 시스템이 이메일 유효성을 검사합니다 (형식 확인, 중복 확인).
8. 문제가 없으면 입력한 이메일로 **6자리 인증 코드**를 발송합니다.
9. 화면이 **"이메일 인증"** 화면으로 전환됩니다.
   - "example@gmail.com으로 인증 코드를 보냈습니다"
   - 6자리 숫자 입력 필드
   - "코드를 받지 못하셨나요? 재발송" 링크
10. 김선생님이 이메일을 확인하고 인증 코드 "123456"을 입력합니다.
11. 인증 코드가 맞으면 **가입이 완료**됩니다.
12. 환영 화면이 나타납니다: "환영합니다, 김선생님!"
13. 자동으로 로그인 상태가 되어 메인 화면(대시보드)으로 이동합니다.
14. 이때 과외 그룹은 아직 없으므로, "첫 번째 과외 그룹을 만들어보세요" 안내가 표시됩니다 (F-002와 연결).

### 시나리오 2: 학생이 초대 코드로 가입하는 경우

**배경**: 이학생은 김선생님에게 과외를 받기로 했습니다. 김선생님이 카카오톡으로 초대 코드 "AB12CD"를 보냈습니다.

**단계**:

1. 이학생이 앱을 처음 실행합니다.
2. "시작하기" 버튼을 누릅니다.
3. **"어떤 사용자이신가요?"** 화면에서 **"학생"**을 선택합니다.
4. 화면이 **"초대 코드 입력"**으로 전환됩니다.
   - "선생님께 받은 초대 코드를 입력해주세요"
   - 6자리 영문+숫자 입력 필드 (예: AB12CD)
   - 입력하면 자동으로 대문자 변환
5. 이학생이 "AB12CD"를 입력합니다.
6. 시스템이 초대 코드를 검증합니다.
   - 유효한 코드인지 확인
   - 만료되지 않았는지 확인 (코드는 생성 후 7일간 유효)
   - 이미 사용된 코드인지 확인
7. 코드가 유효하면 회원가입 폼이 나타납니다:
   - **이메일**
   - **비밀번호**
   - **비밀번호 확인**
   - **이름**: 이학생
   - 전화번호 (선택)
   - **학년**: 중1 / 중2 / 중3 / 고1 / 고2 / 고3 / 재수생 / 기타 (드롭다운)
   - **학교**: (선택사항, 텍스트 입력)
8. 모든 필수 필드를 채우고 "가입하기"를 누릅니다.
9. 이메일로 인증 코드가 발송됩니다.
10. 인증 코드를 입력하여 이메일을 인증합니다.
11. 가입이 완료되고 자동으로 로그인됩니다.
12. 중요: 이학생은 **자동으로 김선생님의 과외 그룹에 추가됩니다** (초대 코드가 특정 선생님의 그룹과 연결되어 있음).
13. 메인 화면에서 김선생님의 과외 그룹이 표시되고, 다음 수업 일정 등을 볼 수 있습니다.

### 시나리오 3: 학부모가 초대 코드로 가입하는 경우

**배경**: 박학부모님은 자녀 이학생이 김선생님께 과외를 받는다는 것을 알고 있습니다. 김선생님이 카카오톡으로 학부모용 초대 코드 "XY56ZW"를 보냈습니다.

**단계**:

1-6. (학생 가입과 동일: 앱 실행 → 학부모 선택 → 초대 코드 입력)
7. 코드가 유효하면 회원가입 폼이 나타납니다:
   - **이메일**
   - **비밀번호**
   - **비밀번호 확인**
   - **이름**: 박학부모
   - 전화번호 (선택)
   - **자녀와의 관계**: 부모 / 조부모 / 기타 (드롭다운)
8-11. (이메일 인증 과정 동일)
12. 가입 완료 후 자동으로 과외 그룹에 추가됩니다.
13. 메인 화면에서 자녀의 수업 현황, 다음 수업 일정, 결제 정보 등을 볼 수 있습니다.

### 시나리오 4: 기존 사용자가 로그인하는 경우

**배경**: 김선생님이 이미 가입되어 있고, 앱을 종료했다가 다시 실행합니다.

**단계**:

1. 앱을 실행합니다.
2. 로그인 화면이 나타납니다:
   - 이메일 입력 필드
   - 비밀번호 입력 필드
   - "로그인" 버튼
   - "비밀번호를 잊으셨나요?" 링크
   - "아직 계정이 없으신가요? 회원가입" 링크
3. 김선생님이 이메일과 비밀번호를 입력합니다.
4. "로그인" 버튼을 누릅니다.
5. 인증 정보가 맞으면 로그인이 완료되고 메인 화면으로 이동합니다.
6. 사용자 유형(선생님/학생/학부모)에 맞는 메인 화면이 표시됩니다.

### 시나리오 5: 비밀번호를 잊어버린 경우

**배경**: 김선생님이 비밀번호를 기억하지 못합니다.

**단계**:

1. 로그인 화면에서 "비밀번호를 잊으셨나요?"를 클릭합니다.
2. **"비밀번호 재설정"** 화면이 나타납니다.
   - "가입할 때 사용한 이메일을 입력해주세요"
   - 이메일 입력 필드
   - "재설정 링크 보내기" 버튼
3. 김선생님이 이메일을 입력하고 버튼을 누릅니다.
4. 시스템이 해당 이메일이 가입되어 있는지 확인합니다.
5. 가입된 이메일이면 **비밀번호 재설정 링크**를 이메일로 발송합니다.
6. 화면에 안내 메시지가 표시됩니다: "example@gmail.com으로 비밀번호 재설정 링크를 보냈습니다. 이메일을 확인해주세요."
7. 김선생님이 이메일을 열고 링크를 클릭합니다.
8. 앱(또는 웹)에서 **"새 비밀번호 설정"** 화면이 열립니다.
   - 새 비밀번호 입력
   - 새 비밀번호 확인
   - "비밀번호 변경" 버튼
9. 새 비밀번호를 입력하고 버튼을 누릅니다.
10. 비밀번호가 변경되고 "비밀번호가 변경되었습니다. 다시 로그인해주세요" 메시지가 표시됩니다.
11. 로그인 화면으로 돌아가서 새 비밀번호로 로그인합니다.

---

## 3. 이 기능에서 일어날 수 있는 문제들

### 회원가입 시 예외 상황

| 문제 상황 | 사용자에게 보여줄 메시지 | 시스템이 할 일 | 비고 |
|----------|----------------------|--------------|------|
| 이미 가입된 이메일로 가입 시도 | "이미 가입된 이메일입니다. 로그인하시겠어요?" | 로그인 화면으로 이동하는 버튼 제공 | 보안상 "가입된 이메일"이라고 명시해도 됨 (일반적인 관행) |
| 이메일 형식이 잘못됨 | "올바른 이메일 형식이 아닙니다" | 입력 필드에 포커스, 빨간색 테두리 | 실시간으로 검증 (입력 중) |
| 비밀번호가 8자 미만 | "비밀번호는 8자 이상이어야 합니다" | 입력 필드 아래 빨간색 경고 표시 | 실시간 검증 |
| 비밀번호에 영문/숫자가 없음 | "비밀번호는 영문과 숫자를 모두 포함해야 합니다" | 입력 필드 아래 경고 표시 | 실시간 검증 |
| 비밀번호 확인이 일치하지 않음 | "비밀번호가 일치하지 않습니다" | 비밀번호 확인 필드에 경고 표시 | 실시간 검증 |
| 필수 필드를 비워둠 | "필수 항목을 모두 입력해주세요" | 비어 있는 필드에 빨간색 표시 | "가입하기" 버튼 누를 때 검증 |
| 전화번호 형식이 잘못됨 | "올바른 전화번호 형식이 아닙니다 (예: 010-1234-5678)" | 전화번호 필드에 경고 표시 | 선택 항목이므로 입력했을 때만 검증 |
| 초대 코드가 틀림 (학생/학부모) | "초대 코드를 확인해주세요" | 초대 코드 입력 화면 유지, 재입력 가능 | 보안상 "유효하지 않은 코드"라고만 표시 |
| 초대 코드가 만료됨 (7일 경과) | "초대 코드가 만료되었습니다. 선생님께 새 코드를 요청해주세요" | 초대 코드 입력 화면 유지 | 선생님에게 자동으로 "학생이 만료된 코드 사용 시도" 알림 발송 |
| 초대 코드가 이미 사용됨 | "이미 사용된 초대 코드입니다. 선생님께 새 코드를 요청해주세요" | 초대 코드 입력 화면 유지 | - |
| 이메일 인증 코드가 틀림 | "인증 코드가 일치하지 않습니다" | 재입력 가능, 5회 실패 시 "재발송" 요구 | - |
| 이메일 인증 코드 만료 (10분) | "인증 코드가 만료되었습니다. 재발송을 요청해주세요" | "재발송" 버튼 강조 표시 | - |
| 네트워크 오류로 가입 실패 | "네트워크 연결을 확인해주세요" | "다시 시도" 버튼 제공 | 입력한 정보는 유지 |

### 로그인 시 예외 상황

| 문제 상황 | 사용자에게 보여줄 메시지 | 시스템이 할 일 | 비고 |
|----------|----------------------|--------------|------|
| 이메일 또는 비밀번호가 틀림 | "이메일 또는 비밀번호가 일치하지 않습니다" | 재입력 가능 | 보안상 어느 쪽이 틀렸는지 명시하지 않음 |
| 가입되지 않은 이메일로 로그인 시도 | "이메일 또는 비밀번호가 일치하지 않습니다" | 재입력 가능 | 위와 동일한 메시지 (보안) |
| 5회 연속 로그인 실패 | "로그인에 5회 실패하여 계정이 일시적으로 잠겼습니다. 10분 후 다시 시도하거나 비밀번호를 재설정해주세요" | 해당 계정 10분간 로그인 차단 | 무차별 대입 공격 방지 |
| 이메일 인증을 완료하지 않은 상태에서 로그인 시도 | "이메일 인증이 완료되지 않았습니다. 가입 시 받은 인증 코드를 입력해주세요" | 이메일 인증 화면으로 이동, "재발송" 옵션 제공 | - |
| 네트워크 오류 | "네트워크 연결을 확인해주세요" | "다시 시도" 버튼 제공 | - |

### 비밀번호 재설정 시 예외 상황

| 문제 상황 | 사용자에게 보여줄 메시지 | 시스템이 할 일 | 비고 |
|----------|----------------------|--------------|------|
| 가입되지 않은 이메일로 재설정 요청 | "해당 이메일로 가입된 계정이 없습니다" | 이메일 입력 화면 유지 | 또는 보안상 "이메일을 발송했습니다"라고만 표시하고 실제로는 발송 안 함 |
| 재설정 링크가 만료됨 (1시간) | "재설정 링크가 만료되었습니다. 다시 요청해주세요" | 비밀번호 재설정 요청 화면으로 이동 | - |
| 새 비밀번호가 이전 비밀번호와 동일 | "이전 비밀번호와 다른 비밀번호를 사용해주세요" | 재입력 요구 | - |
| 새 비밀번호가 규칙 미충족 | "비밀번호는 8자 이상, 영문과 숫자를 포함해야 합니다" | 입력 필드에 경고 표시 | - |

---

## 4. 비즈니스 규칙

### 비밀번호 규칙
- **최소 길이**: 8자 이상
- **필수 포함**: 영문 대소문자 + 숫자
- **권장 포함**: 특수문자 (필수 아님)
- **최대 길이**: 50자

### 이메일 인증
- **인증 코드**: 6자리 숫자 (랜덤 생성)
- **유효 시간**: 10분
- **재발송 제한**: 1분에 1회만 가능 (스팸 방지)
- **실패 제한**: 5회 실패 시 10분간 인증 차단

### 초대 코드 (학생/학부모용)
- **형식**: 6자리 영문 대문자 + 숫자 (예: AB12CD)
- **유효 기간**: 생성 후 7일
- **사용 횟수**: 1회만 사용 가능 (1인 1코드)
- **선생님당 생성 가능 개수**: 무제한

### 로그인 보안
- **실패 제한**: 5회 연속 실패 시 10분간 계정 잠김
- **세션 유지**: 로그인 상태는 30일간 유지 (사용자가 로그아웃하지 않는 한)
- **자동 로그아웃**: 보안 설정에서 선택 가능 (매번 로그인 / 30일 유지)

### 비밀번호 재설정
- **재설정 링크 유효 시간**: 1시간
- **재설정 후**: 기존 세션 모두 종료 (다른 기기에서 로그인되어 있어도 로그아웃됨)

---

## 5. 사용자별 권한

### 선생님
- ✅ 독립적으로 회원가입 가능
- ✅ 과외 그룹 생성 가능 (F-002)
- ✅ 초대 코드 생성 가능 (F-002)

### 학생
- ❌ 독립적으로 회원가입 불가능 (초대 코드 필수)
- ✅ 선생님의 초대 코드로만 가입 가능
- ✅ 가입 시 자동으로 해당 선생님의 과외 그룹에 추가됨

### 학부모
- ❌ 독립적으로 회원가입 불가능 (초대 코드 필수)
- ✅ 선생님의 초대 코드로만 가입 가능
- ✅ 가입 시 자동으로 해당 선생님의 과외 그룹에 추가됨

---

## 6. UI 요구사항

### 회원가입 화면
- **사용자 유형 선택**: 큰 카드 형식으로 3개 옵션 명확히 구분
- **입력 폼**: 한 화면에 모든 필드 표시 (스크롤 가능)
- **실시간 검증**: 비밀번호 규칙, 이메일 형식 등을 입력하는 중에 검증
- **진행 상태**: 회원가입 → 이메일 인증 → 완료 단계를 상단에 표시

### 로그인 화면
- **간결함**: 이메일, 비밀번호 입력만 (추가 정보 최소화)
- **자동 완성 지원**: 이메일 자동 완성 가능
- **비밀번호 표시/숨김**: 눈 아이콘으로 토글

### 이메일 인증 화면
- **발송된 이메일 주소 표시**: "example@gmail.com으로 인증 코드를 보냈습니다"
- **6자리 입력 필드**: 자동으로 하이픈이나 구분 없이 연속 입력
- **재발송 버튼**: 1분 후 활성화 (카운트다운 표시)

---

## 7. 다른 기능과의 연결

### F-002: 과외 그룹 생성 및 매칭
- 선생님이 회원가입 완료 후 첫 과외 그룹을 만들 수 있음
- 학생/학부모가 초대 코드로 가입하면 자동으로 해당 그룹에 추가됨

### F-013: 푸시 알림
- 이메일 인증 코드를 이메일로 발송
- 비밀번호 재설정 링크를 이메일로 발송

---

## 8. 향후 고려사항 (2단계 이후)

현재 MVP에서는 이메일 인증만 지원하지만, 나중에 추가할 수 있는 기능들:

- **소셜 로그인**: 카카오, 네이버, 구글 계정으로 간편 가입/로그인
- **휴대폰 인증**: 이메일 대신 SMS로 인증
- **2단계 인증 (2FA)**: 보안 강화를 위한 추가 인증 단계
- **생체 인증**: 지문, 얼굴 인식으로 로그인 (모바일)

---

## 9. 성공 지표

이 기능이 제대로 작동하는지 측정하는 기준:

- **가입 완료율**: 회원가입 시작한 사용자 중 이메일 인증까지 완료한 비율 (목표: 80% 이상)
- **가입 소요 시간**: 시작부터 완료까지 평균 시간 (목표: 3분 이내)
- **로그인 성공률**: 로그인 시도 중 성공한 비율 (목표: 95% 이상)
- **비밀번호 재설정 빈도**: 전체 사용자 중 월간 비밀번호 재설정 요청 비율 (목표: 5% 미만)

---

**다음 기능**: F-002 과외 그룹 생성 및 매칭

---

## 변경 이력

| 버전 | 날짜 | 변경 내용 | 작성자 |
|------|------|----------|--------|
| v1.0 | 2025-10-31 | 초안 작성 | - |
